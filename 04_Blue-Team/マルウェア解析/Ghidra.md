# Ghidra 詳細ガイド

Ghidraは、アメリカ国家安全保障局（NSA）が開発したリバースエンジニアリングツールです。バイナリコードやマルウェア、ソフトウェアの脆弱性を分析するために広く使用されています。このガイドでは、Ghidraの基本的な使い方と、具体的な例を解説付きで紹介します。

## 目次
1. [Ghidraのインストール](#ghidraのインストール)
2. [プロジェクトの作成](#プロジェクトの作成)
3. [バイナリのインポート](#バイナリのインポート)
4. [デコンパイル](#デコンパイル)
5. [関数の逆解析](#関数の逆解析)
6. [スクリプトの使用](#スクリプトの使用)
7. [まとめ](#まとめ)

## Ghidraのインストール

Ghidraのインストールは非常に簡単です。公式ウェブサイトからGhidraのアーカイブファイルをダウンロードし、解凍するだけで利用可能になります。

```bash
# ダウンロード後、アーカイブを解凍する
tar -xvf ghidra_10.x.x_PUBLIC_YYYYMMDD.zip
cd ghidra_10.x.x_PUBLIC
```

Ghidraのメインプログラムを実行するには、`ghidraRun`スクリプトを使用します。

```bash
./ghidraRun
```

## プロジェクトの作成

Ghidraを起動したら、まずは新しいプロジェクトを作成します。プロジェクトは、解析するすべてのバイナリやデータを管理するためのコンテナです。

1. Ghidraを起動後、`File` > `New Project`を選択します。
2. プロジェクトの保存場所を選び、プロジェクト名を入力します。
3. `Non-Shared Project`（非共有プロジェクト）を選択して`Next`をクリックします。

## バイナリのインポート

プロジェクトを作成したら、次に解析するバイナリファイルをインポートします。

1. `File` > `Import File` を選択します。
2. 解析したいバイナリファイルを選択し、`OK`をクリックします。
3. インポートが完了すると、バイナリがプロジェクトウィンドウに表示されます。

## デコンパイル

Ghidraの強力な機能の一つは、バイナリコードを人間が読みやすいC言語のようなコードに変換（デコンパイル）できることです。

1. バイナリをインポートした後、`CodeBrowser`ウィンドウで解析対象のファイルをダブルクリックします。
2. `Window` > `Decompiler` を選択してデコンパイラウィンドウを開きます。
3. 関数を選択すると、対応するデコンパイル結果が表示されます。

## 関数の逆解析

Ghidraでは、関数の逆解析を行い、その機能や目的を理解することができます。

1. `CodeBrowser`で逆解析したい関数を右クリックし、`Function` > `Disassemble`を選択します。
2. アセンブリコードが表示されるので、各命令の意味を確認します。
3. コメントを追加するには、対象の命令を右クリックし、`Comment`を選択します。

## スクリプトの使用

Ghidraは、PythonやJavaを使用してカスタムスクリプトを作成し、逆解析のプロセスを自動化できます。

### 例: 全関数のリストを表示するPythonスクリプト

```python
#@category Examples
# 全関数をリスト表示するスクリプト

from ghidra.program.model.listing import FunctionManager

functionManager = currentProgram.getFunctionManager()
functions = functionManager.getFunctions(True)

for function in functions:
    print(function.getName())
```

このスクリプトを実行すると、現在のプログラム内のすべての関数名が表示されます。

## まとめ

Ghidraは非常に強力なリバースエンジニアリングツールであり、バイナリのデコンパイルや逆解析に役立ちます。基本的な使い方から、スクリプトを使った高度な解析まで、多くの機能が揃っているため、セキュリティリサーチャーや逆アセンブリが必要な技術者にとっては非常に有用です。

以上で、Ghidraの詳細ガイドを終わります。さらなる情報は公式ドキュメントを参照してください。
