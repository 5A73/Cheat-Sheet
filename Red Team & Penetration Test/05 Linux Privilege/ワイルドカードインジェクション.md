ワイルドカードインジェクションは、シェルやコマンドラインインターフェース（CLI）で使用されるワイルドカード（`*`, `?`, `[ ]` など）を悪用する攻撃手法です。この攻撃は、特に`rm`, `cp`, `mv`, `tar`, `chmod` などのコマンドで、ファイル操作の文脈で発生することが多いです。

### 攻撃手法の概要

1. **ワイルドカードの解釈**: シェルがワイルドカードを展開する際に、予期しないファイルやディレクトリが指定されたり、コマンドが実行されたりします。

2. **悪意あるファイル名の作成**: 攻撃者は、ワイルドカードを含むファイル名や、特殊な名前（例: `-rf` や `--`, `|`）を持つファイルを作成し、シェルがこれを解釈して予期しない動作を行うように仕向けます。

### 実例

#### 例1: `rm`コマンドへのインジェクション

攻撃者が`-rf`という名前のファイルを作成し、管理者が次のコマンドを実行するとします。
```bash
touch ”-rf”
```
```bash
rm *
```

この場合、シェルはファイル`-rf`を解釈し、コマンドは次のように実行されます。

```bash
rm -rf
```

これは、ディレクトリ全体を削除する危険なコマンドになってしまいます。

#### 例2: `tar`コマンドへのインジェクション

攻撃者が次のようなファイル名を作成します。

```bash
touch "--checkpoint-action=exec=sh shell.sh"
```

管理者が、以下のように`tar`コマンドでアーカイブを作成するとします。

```bash
tar -cf archive.tar *
```

このコマンド実行時に`--checkpoint-action=exec=sh shell.sh`が解釈され、`shell.sh`というスクリプトが実行されてしまいます。

### 防御策

1. **絶対パスの使用**: コマンド実行時に、特に重要なファイル操作では絶対パスを使う。

2. **ワイルドカードの回避**: ワイルドカードの使用を慎重に行い、代わりに具体的なファイル名や安全なパターンを使用する。

3. **ファイル名のフィルタリング**: 信頼できないファイル名を扱う際には、`--`を使ってファイル名リストの終端を明示するか、予期しないオプションが付加されないようにする。

4. **引数の検証**: コマンドライン引数を適切に検証し、危険な入力をフィルタリングする。

### 結論

ワイルドカードインジェクションは、システムの制御を失わせる可能性があるため、特に管理者権限でのコマンド実行時には注意が必要です。システム操作を安全に行うためには、ワイルドカードやファイル名に対する注意深い扱いが不可欠です。